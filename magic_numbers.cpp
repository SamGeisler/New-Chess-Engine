#include "magic_numbers.h"
#include "precompute.h"
#include "lookup.h"

namespace MagicNumbers{
    uint64_t rookNums[64] = {0xC9873C62385CB89F, 0x10C31FAD8CEAA30D, 0xCF5E04D70671F0A3, 0x89B92A9D723B3B55, 0xC6E64BC5D919CBB3, 0xA514179558BC361D, 0x39C013037F09CD08, 0xDC11AB87F9E635EE, 0x33FCAF149167CBB1, 0xF0215351FA4EC13B, 0x3C44E943A79118D2, 0xCF128B254EED659, 0x63F09D52A0509D44, 0xABFC00C31FE1314, 0x38E0900BA684979F, 0x3EDE5454B04943B4, 0x9659334D6162F60, 0x5AF94E9FFD7A217E, 0x7F7D05ED060861C, 0xFB4B3E0020060310, 0x3C6FAF0F0EC909B7, 0x347362A006C981FD, 0x9FB084004B1E2850, 0x4FB2CA001C0DC58D, 0x5CDCAFEA46A19FDE, 0x3B70668273DBE7B6, 0x3082A6E8778A81DD, 0x4E7625655222EBBF, 0x5D49263BDF92B3B, 0x4B34083FEF84EE24, 0xF0606F5D83103C07, 0x80BA1062000B1F6C, 0xFEA44F41CA00125F, 0xD3D59728BFC03E5A, 0xDF4DEAA4B06AACAD, 0x78BF37ACC851F48D, 0x13DCE28A85A5A5BE, 0x56BB0A640011EA52, 0xB95428160C00D005, 0x69E48ECA21937837, 0xB03CF520F600A3D7, 0x6F8A5D37EC9F3322, 0x896B24E807605401, 0xFA475610D9F0DA1C, 0xAA650F8B20FF8B2D, 0x26A2EFC4E588008D, 0x931C232238140050, 0x55E5E50369860004, 0x71771395C22470D0, 0x3BE6B33D60BD7A78, 0xF46155ECEADFBA2D, 0xB4120CC4D6002200, 0x7BA585BBD17876F1, 0xBC6CB45A2DB5A600, 0x5E31AF411D2F5210, 0x52B9741295094A00, 0x7737816369C2E06E, 0x8F9C400103F08321, 0x7431A0008A704301, 0x8B82A0C01AEA0012, 0xC75982DF3C2C1D2, 0xE5AE01920F078582, 0xADDB860488103104, 0xA8B31F0A8B426BFA};
    uint64_t bishopNums[64] = {0x3D40145521470103, 0x606D029090D0048, 0x28D01B0A0F240137, 0x5A07EA7CF43E9D4F, 0x4624042260BCCDF3, 0x2C60304602EEDFE, 0xA043EC039587147D, 0xE863220910051055, 0xF43CBC84500C4D02, 0x803E48010803A905, 0xBF32C1DE02510B20, 0x509B5820D4C485C2, 0x1FAFD41C20709799, 0x6D96C2080E1952A3, 0x547306C606304007, 0x2B6CB60B04063E86, 0xA1F1FC750FD00720, 0x652422D04508450B, 0x4E5814100BC31460, 0x3B27B8AF68E01031, 0x8C0BFE72836BEF99, 0x24719D233B0B73C3, 0x89FD8EC7541057F7, 0xE9EB05DE2C060E04, 0x82604587B8086818, 0x327B709A600A0E06, 0x69791C9646F632DF, 0xCAA10210E5F0803A, 0xA51846AE650F6F41, 0x53C4398F9EEF70F2, 0x294A508EE08062D, 0xC6EB02C4E1041F92, 0x9CB22020CFFD082E, 0x937D1C2084F2581A, 0xB44E4128145007C0, 0x5E384DB8E5A5A2, 0xD86D7DB9A8F6E8EB, 0x1C3A5BAB004E0097, 0x59838150323D701, 0x6F711AC903B6011E, 0xFEE91420E04074A1, 0x4D440B0818616651, 0xAEAB8EF2EFF9B3DC, 0x210F2E0972561333, 0xF8B57A9685A15280, 0x5C403410C4106B80, 0x5E065C8D020A8C01, 0x791C388601421206, 0xA043EC039587147D, 0x18C0A40744300FE4, 0x21E28AEDA8D00698, 0x22723A2E42021C25, 0x441A2151B20E0043, 0x5DC3E0B4694A0187, 0x34D1F09A27E0D2FE, 0x606D029090D0048, 0xE863220910051055, 0x2B6CB60B04063E86, 0x643054DB6C16180D, 0x791C388601421206, 0x69DFDD4D701E1601, 0x330C10C8F11B2200, 0xF43CBC84500C4D02, 0x3D40145521470103};
    int rookWidths[64] = {13, 12, 13, 13, 13, 13, 12, 13, 12, 11, 11, 11, 11, 11, 11, 12, 12, 11, 11, 11, 11, 11, 10, 11, 12, 11, 11, 11, 11, 11, 11, 11, 12, 11, 11, 11, 11, 11, 10, 12, 12, 11, 11, 11, 11, 11, 10, 11, 12, 11, 11, 11, 11, 11, 11, 11, 13, 11, 11, 11, 12, 12, 11, 12};
    int bishopWidths[64] = {6, 5, 5, 5, 5, 5, 5, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 7, 8, 8, 8, 5, 5, 5, 5, 8, 10, 11, 8, 5, 5, 5, 5, 7, 11, 11, 7, 5, 5, 5, 5, 8, 8, 8, 7, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 5, 5, 5, 5, 5, 5, 6};


    uint64_t genDestRook(int src, uint64_t pieces){
        uint64_t intersectBB = BitboardLookup::ROOK_DEST_TRUNC[src] & pieces;
        int index = rookNums[src] * intersectBB >> (64-rookWidths[src]);
        return Precompute::rookDestIntersected[src][index];
    }

    uint64_t genDestBishop(int src, uint64_t pieces){
        uint64_t intersectBB = BitboardLookup::BISHOP_DEST_TRUNC[src] & pieces;
        int index = bishopNums[src] * intersectBB >> (64-bishopWidths[src]);
        return Precompute::bishopDestIntersected[src][index];
    }
}